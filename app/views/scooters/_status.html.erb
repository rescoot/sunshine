<!-- Status Indicators -->
<div class="my-6 flex flex-wrap gap-2">
  <% if scooter.vin.present? %>
    <span 
      id="scooter-vin" 
      class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-pointer"
      onclick="copyToClipboard('scooter-vin', 'vin-copy-message')"
      title="Click to copy VIN">
      VIN: <%= scooter.vin %>
    </span>
    <span id="vin-copy-message" class="hidden text-xs text-green-600">Copied!</span>
  <% end %>

  <% if scooter.imei.present? %>
    <span 
      id="scooter-imei" 
      class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10 cursor-pointer"
      onclick="copyToClipboard('scooter-imei', 'imei-copy-message')"
      title="Click to copy IMEI">
      IMEI: <%= scooter.imei %>
    </span>
    <span id="imei-copy-message" class="hidden text-xs text-green-600">Copied!</span>
  <% end %>

  <% if scooter.is_online? %>
    <span class="inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20" title="<%= scooter.last_seen_at %>">Online</span>
  <% elsif scooter.last_seen_at %>
    <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/20">Last seen <%= time_ago_in_words(scooter.last_seen_at) %> ago</span>
  <% else %>
    <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/20">Offline</span>
  <% end %>
  
  <span class="inline-flex items-center rounded-md <%= scooter.unlocked? ? 'bg-green-50 text-green-700 ring-green-600/20' : 'bg-red-50 text-red-700 ring-red-600/20' %> px-2 py-1 text-xs font-medium ring-1 ring-inset">
    <%= scooter.state %>
  </span>

  <span class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10">
    Kickstand <%= scooter.kickstand&.titleize || 'unknown' %>
  </span>

  <span class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10">
    Seatbox <%= scooter.seatbox&.titleize || 'unknown' %>
  </span>

  <span class="inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20">
    <% if scooter.estimated_range %>
      <%= scooter.estimated_range %> km range
    <% else %>
      Range unknown
    <% end %>
  </span>

  <% if scooter.location? %>
    <span class="inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-inset ring-purple-600/20" title="<%= scooter.location.timestamp %>">
      <%= number_with_precision(scooter.location.lat, precision: 6) %>, <%= number_with_precision(scooter.location.lng, precision: 6) %>
    </span>
  <% else %>
    <span class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10">
      Location unknown
    </span>
  <% end %>

  <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset <%= battery_status_classes(scooter.battery0_level) %>">
    Main <%= number_to_percentage(scooter.battery0_level, precision: 0) %>
  </span>

  <% if scooter.battery1_level > 0.0 %>
    <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset <%= battery_status_classes(scooter.battery1_level) %>">
      Spare <%= number_to_percentage(scooter.battery1_level, precision: 0) %>
    </span>
  <% end %>

  <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset <%= battery_status_classes(scooter.cbb_battery_level) %>">
    CBB <%= number_to_percentage(scooter.cbb_battery_level, precision: 0) %>
  </span>

  <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset <%= battery_status_classes(scooter.aux_battery_level) %>">
    Aux <%= number_to_percentage(scooter.aux_battery_level, precision: 0) %>
  </span>
</div>

<script>
  function copyToClipboard(elementId, messageId) {
    const element = document.getElementById(elementId);
    const text = element.textContent.replace(/^(VIN|IMEI): /, '').trim();
    
    navigator.clipboard.writeText(text).then(() => {
      // Show the success message
      const message = document.getElementById(messageId);
      message.classList.remove('hidden');
      
      // Hide the message after 2 seconds
      setTimeout(() => {
        message.classList.add('hidden');
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
</script>
